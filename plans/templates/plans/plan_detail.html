<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>å‡¦é‡æ”¹å–„è¨ˆç”»æ›¸è©³ç´°</title>
    <style>
        body { font-family: sans-serif; max-width: 1200px; margin: 20px auto; padding: 0 20px; background: #f5f5f5; }
        h1 { color: #333; }
        .controls { margin-bottom: 20px; }
        .controls a { display: inline-block; padding: 10px 20px; background: #667eea; color: white; text-decoration: none; border-radius: 5px; margin-right: 10px; }
        .section { background: white; padding: 25px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .section h2 { margin-top: 0; color: #667eea; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0; }
        .info-item { padding: 12px; background: #f9f9f9; border-radius: 5px; }
        .info-item label { font-weight: bold; display: block; margin-bottom: 5px; color: #666; font-size: 0.9em; }
        .info-item .value { font-size: 1.1em; color: #333; }
        .requirement-list { list-style: none; padding: 0; }
        .requirement-list li { padding: 12px; margin: 8px 0; background: #f9f9f9; border-radius: 5px; display: flex; align-items: center; }
        .requirement-list li.met { background: #d4edda; border-left: 4px solid #28a745; }
        .requirement-list li.not-met { background: #f8d7da; border-left: 4px solid #dc3545; }
        .icon { margin-right: 10px; font-size: 1.2em; }
        .badge { padding: 8px 15px; border-radius: 5px; font-weight: bold; display: inline-block; }
        .badge-success { background: #d4edda; color: #155724; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        .big-number { font-size: 2em; font-weight: bold; color: #667eea; }
        .workplace-count { display: flex; justify-content: space-around; margin: 20px 0; }
        .workplace-count .item { text-align: center; padding: 20px; background: #f9f9f9; border-radius: 5px; }
        .workplace-count .item .number { font-size: 2.5em; font-weight: bold; color: #667eea; }
        .workplace-count .item .label { color: #666; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ“‹ å‡¦é‡æ”¹å–„è¨ˆç”»æ›¸ è©³ç´°</h1>
    
    <div class="controls">
        <a href="/plans/">ğŸ“‹ ä¸€è¦§ã«æˆ»ã‚‹</a>
        <a href="/admin/plans/improvementplan/{{ plan.id }}/change/">âœï¸ ç·¨é›†</a>
        <a href="/">ğŸ  ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸</a>
    </div>
    
    <!-- åŸºæœ¬æƒ…å ± -->
    <div class="section">
        <h2>ğŸ“„ åŸºæœ¬æƒ…å ±</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>äº‹æ¥­è€…</label>
                <div class="value">{{ plan.provider.name }}</div>
            </div>
            <div class="info-item">
                <label>å¯¾è±¡å¹´åº¦</label>
                <div class="value">{{ plan.fiscal_year }}å¹´åº¦</div>
            </div>
            <div class="info-item">
                <label>ç”³è«‹ã™ã‚‹åŠ ç®—åŒºåˆ†</label>
                <div class="value">{{ plan.get_target_addition_tier_display }}</div>
            </div>
            <div class="info-item">
                <label>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                <div class="value">{{ plan.get_status_display }}</div>
            </div>
        </div>
        
        <div class="info-item" style="margin-top: 15px;">
            <label>å¯¾è±¡äº‹æ¥­æ‰€</label>
            <div class="value">
                {% for facility in plan.target_facilities.all %}
                    {{ facility.name }}{% if not forloop.last %},{% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
    
    <!-- åˆ¤å®šçµæœ -->
    <div class="section">
        <h2>âœ… åŠ ç®—åŒºåˆ†åˆ¤å®šçµæœ</h2>
        {% if eligible_tier %}
        <div style="text-align: center; padding: 30px;">
            <div class="badge badge-success" style="font-size: 1.5em;">
                å–å¾—å¯èƒ½: {{ plan.get_determined_addition_tier_display|default:eligible_tier }}
            </div>
            <p style="margin-top: 20px; color: #666;">ã™ã¹ã¦ã®è¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã™</p>
        </div>
        {% else %}
        <div style="text-align: center; padding: 30px;">
            <div class="badge badge-danger" style="font-size: 1.5em;">
                è¦ä»¶ä¸è¶³
            </div>
            <p style="margin-top: 20px; color: #666;">ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹è¦ä»¶ã¾ãŸã¯è·å ´ç’°å¢ƒç­‰è¦ä»¶ãŒä¸è¶³ã—ã¦ã„ã¾ã™</p>
        </div>
        {% endif %}
    </div>
    
    <!-- ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹è¦ä»¶ -->
    <div class="section">
        <h2>ğŸ¯ ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹è¦ä»¶</h2>
        <ul class="requirement-list">
            {% for item in career_path_status %}
            <li class="{% if item.met %}met{% else %}not-met{% endif %}">
                <span class="icon">{% if item.met %}âœ…{% else %}âŒ{% endif %}</span>
                <span>{{ item.name }}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- è·å ´ç’°å¢ƒç­‰è¦ä»¶ -->
    <div class="section">
        <h2>ğŸ¢ è·å ´ç’°å¢ƒç­‰è¦ä»¶</h2>
        <p style="color: #666; margin-bottom: 20px;">å„åŒºåˆ†ã‹ã‚‰1ã¤ä»¥ä¸Šã®å–ã‚Šçµ„ã¿ãŒå¿…è¦ã§ã™</p>
        
        <div class="workplace-count">
            {% for key, status in workplace_status.items %}
            <div class="item">
                <div class="number">{{ status.count }}</div>
                <div class="label">{{ status.name }}</div>
                <div style="margin-top: 10px;">
                    {% if status.count >= status.required %}
                    <span style="color: #28a745; font-weight: bold;">âœ“ å……è¶³</span>
                    {% else %}
                    <span style="color: #dc3545; font-weight: bold;">âœ— ä¸è¶³</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div style="margin-top: 20px;">
            <h3 style="color: #666;">å®Ÿæ–½ã™ã‚‹å–ã‚Šçµ„ã¿ä¸€è¦§</h3>
            <ul style="list-style: none; padding: 0;">
                {% for initiative in plan.workplace_initiatives.all %}
                <li style="padding: 10px; margin: 5px 0; background: #f9f9f9; border-radius: 3px;">
                    <strong>[{{ initiative.get_category_display }}]</strong> {{ initiative.description }}
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    
    <!-- åŠ ç®—è¦‹è¾¼é¡ -->
    <div class="section">
        <h2>ğŸ’° åŠ ç®—è¦‹è¾¼é¡</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>ç·å˜ä½æ•°ï¼ˆå¹´é–“ï¼‰</label>
                <div class="value">{{ plan.total_service_units|floatformat:0 }} å˜ä½</div>
            </div>
            <div class="info-item">
                <label>åŠ ç®—ç‡</label>
                <div class="value">{{ plan.addition_rate }}%</div>
            </div>
        </div>
        
        <div style="text-align: center; padding: 30px; background: #f9f9f9; border-radius: 5px; margin-top: 20px;">
            <div style="color: #666; margin-bottom: 10px;">å¹´é–“åŠ ç®—è¦‹è¾¼é¡</div>
            <div class="big-number">{{ plan.estimated_addition_amount|floatformat:0 }} å††</div>
        </div>
    </div>
    
    <!-- é…åˆ†è¨ˆç”» -->
    {% if plan.total_salary_increase %}
    <div class="section">
        <h2>ğŸ“Š é…åˆ†è¨ˆç”»</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>è³ƒé‡‘æ”¹å–„ç·é¡</label>
                <div class="value">{{ plan.total_salary_increase|floatformat:0 }} å††</div>
            </div>
            <div class="info-item">
                <label>åŸºæœ¬çµ¦ã®å¼•ãä¸Šã’</label>
                <div class="value">{{ plan.base_salary_increase|floatformat:0 }} å††</div>
            </div>
            <div class="info-item">
                <label>æ‰‹å½“ã®å¼•ãä¸Šã’</label>
                <div class="value">{{ plan.allowance_increase|floatformat:0 }} å††</div>
            </div>
            <div class="info-item">
                <label>è³ä¸ã®å¼•ãä¸Šã’</label>
                <div class="value">{{ plan.bonus_increase|floatformat:0 }} å††</div>
            </div>
        </div>
    </div>
    {% endif %}
</body>
</html>
